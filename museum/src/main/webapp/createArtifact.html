<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Artifact - Museum Management</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

<div class="container">

    <!-- FULL HEADER -->
    <div class="header">
        <h1 id="pageTitle">Create New Artifact</h1>
        <div class="header-right" id="headerUser">Welcome, User</div>
    </div>

    <!-- FULL-WIDTH NAVBAR -->
    <div class="navbar-wrapper">
        <nav class="navbar">
            <ul>
                <li><a href="dashboard.html">Dashboard</a></li>
                <li><a href="createArtifact.html" class="active">Create Artifact</a></li>
                <li><a href="searchArtifact.html">Search Artifacts</a></li>
                <li><a href="logout">Logout</a></li>
            </ul>
        </nav>
    </div>

    <!-- FORM CONTAINER -->
    <div class="form-container">

        <div id="alertContainer"></div>

        <div class="card">
            <form id="createArtifactForm" onsubmit="handleCreate(event)">

                <div class="form-group">
                    <label for="artifactName">Artifact Name *</label>
                    <input type="text" id="artifactName" name="artifactName" required maxlength="200"
                           pattern="^[A-Za-z0-9\\s\\-.,()]+$"
                           title="Only letters, numbers, spaces, hyphens, commas, periods, and parentheses allowed">
                </div>

                <div class="form-group">
                    <label for="artifactCode">Artifact Code *</label>
                    <input type="text" id="artifactCode" name="artifactCode" required maxlength="50">
                </div>

                <div class="form-group">
                    <label for="category">Category *</label>
                    <select id="category" name="category" required>
                        <option value="">Select Category</option>
                        <option value="Sculpture">Sculpture</option>
                        <option value="Painting">Painting</option>
                        <option value="Pottery">Pottery</option>
                        <option value="Jewelry">Jewelry</option>
                        <option value="Textile">Textile</option>
                        <option value="Weapon">Weapon</option>
                        <option value="Tool">Tool</option>
                        <option value="Document">Document</option>
                        <option value="Coin">Coin</option>
                        <option value="Furniture">Furniture</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" name="description" rows="4"
                              placeholder="Enter detailed description of the artifact"></textarea>
                </div>

                <div class="form-group">
                    <label for="period">Period</label>
                    <input type="text" id="period" name="period"
                           placeholder="e.g., Ancient Egypt, Renaissance, etc.">
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Create Artifact</button>
                </div>

            </form>

            <div class="text-center mt-20">
                <a href="dashboard.html" class="btn btn-secondary">Back to Dashboard</a>
            </div>

        </div>
    </div>

</div>

<script>
    // Update page title
    document.getElementById("pageTitle").innerText = "Create New Artifact";

    // Load username from localStorage
    document.getElementById("headerUser").innerText = 
        "Welcome, " + (localStorage.getItem("username") || "User");

    // Form submit handler
    async function handleCreate(event) {
        event.preventDefault();

        const formData = new URLSearchParams(new FormData(document.getElementById("createArtifactForm")));

        try {
            const response = await fetch("createArtifact", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: formData.toString()
            });

            const data = await response.json();

            if (data.success) {
                alert("Artifact created successfully!");
                window.location.href = "dashboard.html";
            } else {
                alert("Error: " + data.error);
            }

        } catch (error) {
            alert("Something went wrong. Please try again.");
        }
    }
</script>

</body>
</html>